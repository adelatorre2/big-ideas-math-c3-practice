% Worksheet header macros
\newcommand{\WorksheetRule}{%
  \par\noindent\rule{\textwidth}{0.4pt}\par%
}

\newcommand{\NameDateLine}{%
  \noindent\textbf{Name:} \rule{0.55\textwidth}{0.4pt}\hfill
  \textbf{Date:} \rule{0.25\textwidth}{0.4pt}\par%
}

\newcommand{\WorkSpace}[1]{\vspace{#1}}

\newcommand{\SolutionRef}[1]{Appendix~\ref{app:solutions}, p.~\pageref{#1}}

\newtcbox{\NavButton}{%
  on line,
  colback=RoyalBlue!10,
  colframe=RoyalBlue!60!black,
  coltext=RoyalBlue!90!black,
  boxrule=0.6pt,
  arc=2mm,
  left=1.2mm,right=1.2mm,top=0.5mm,bottom=0.5mm,
  drop shadow,
}

\newcommand{\NavToContents}{%
  \hyperref[contents]{\NavButton{\ensuremath{\leftarrow}\,Contents}}%
}

\newcommand{\NavToSolutions}[1]{%
  \hyperref[#1]{\NavButton{\ensuremath{\checkmark}\,Solutions}}%
}

\newcommand{\NavToPrint}[1]{%
  \href{#1}{\NavButton{Print}}%
}

\newcommand{\WorksheetHeader}[3]{%
  \WorksheetRule
  \vspace{0.5em}
  {\Large\bfseries #1\par}
  {\small #2\par}
  {\itshape #3\par}
  \vspace{0.4em}
  \NameDateLine
  \vspace{0.3em}
  \WorksheetRule
  \vspace{0.75em}
}

\newcommand{\WorksheetHeaderNav}[5]{%
  \WorksheetRule
  \vspace{0.35em}
  {\small\noindent%
    \NavToContents%
    \if\relax\detokenize{#4}\relax\else
      \hspace{0.5em}\NavToSolutions{#4}%
    \fi
    \if\relax\detokenize{#5}\relax\else
      \hspace{0.5em}\NavToPrint{#5}%
    \fi
    \par
  }%
  \vspace{0.4em}
  {\Large\bfseries #1\par}
  {\small #2\par}
  {\itshape #3\par}
  \vspace{0.4em}
  \NameDateLine
  \vspace{0.3em}
  \WorksheetRule
  \vspace{0.75em}
}

\newcounter{worksheet}
\newcommand{\WorksheetHeaderAuto}[3]{%
  \stepcounter{worksheet}%
  \WorksheetHeader{Worksheet \theworksheet: #1}{#2}{#3}%
}
